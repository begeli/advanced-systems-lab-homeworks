Speedup over standard C optimized version: 2.666